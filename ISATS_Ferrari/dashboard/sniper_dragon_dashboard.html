<!DOCTYPE html>

<html class="dark" lang="ko">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>AI 인지 흐름 및 의사결정 분석</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#25e2f4",
                        "background-light": "#f5f8f8",
                        "background-dark": "#102122",
                        "success": "#4ade80",
                        "danger": "#f87171",
                    },
                    fontFamily: {
                        "display": ["Space Grotesk", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        body {
            font-family: 'Space Grotesk', sans-serif;
            -webkit-font-smoothing: antialiased;
        }

        .scanline {
            background: linear-gradient(to bottom, rgba(37, 226, 244, 0.1) 50%, rgba(0, 0, 0, 0) 50%);
            background-size: 100% 4px;
        }
    </style>
    <style>
        body {
            min-height: max(884px, 100dvh);
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark text-white min-h-screen flex flex-col max-w-[430px] mx-auto border-x border-white/10">
    <!-- TopAppBar -->
    <div
        class="sticky top-0 z-50 flex items-center bg-background-light dark:bg-background-dark p-4 pb-2 justify-between border-b border-white/10 backdrop-blur-md">
        <div class="text-white flex size-12 shrink-0 items-center justify-start cursor-pointer">
            <span class="material-symbols-outlined">arrow_back_ios</span>
        </div>
        <div class="flex-1 text-center">
            <h2 class="text-white text-lg font-bold leading-tight tracking-[-0.015em]">AI Cognitive Flow</h2>
            <p class="text-[10px] text-primary uppercase tracking-widest font-bold"><span
                    id="engine_mode_text">INIT</span> • <span id="last_update_text">LIVE</span></p>
        </div>
        <div class="flex w-12 items-center justify-end">
            <button
                class="flex size-10 cursor-pointer items-center justify-center rounded-lg bg-primary/10 text-primary hover:bg-primary/20 transition-all">
                <span class="material-symbols-outlined">analytics</span>
            </button>
        </div>
    </div>
    <div class="flex-1 overflow-y-auto pb-24">
        <!-- Section: Gemini 1.5 Thought Stream -->
        <div class="mt-4">
            <h4 class="text-[#9cb7ba] text-[11px] font-bold leading-normal tracking-[0.2em] px-4 py-2 uppercase">Gemini
                1.5 Thought Stream</h4>
            <div
                class="mx-4 bg-black/40 border border-white/5 rounded-xl p-4 font-mono text-sm relative overflow-hidden">
                <div class="absolute top-0 right-0 p-2 opacity-30">
                    <span class="material-symbols-outlined text-xs">terminal</span>
                </div>
                <div class="space-y-2">
                    <div class="flex gap-2">
                        <span class="text-primary opacity-50">[09:41:02]</span>
                        <p class="text-white/80">Ingesting real-time sentiment from 14 global news nodes...</p>
                    </div>
                    <div class="flex gap-2">
                        <span class="text-primary opacity-50">[09:41:05]</span>
                        <p class="text-primary">PATTERN MATCH: Bullish fractal detected on NVDA 15m candle.</p>
                    </div>
                    <div class="flex gap-2">
                        <span class="text-primary opacity-50">[09:41:08]</span>
                        <p class="text-white/80">Cross-referencing historical earnings gap scenarios (n=4,209)...</p>
                    </div>
                    <div class="flex gap-2">
                        <span class="text-primary opacity-50">[09:41:12]</span>
                        <p class="text-white/60 italic">"Probabilistic outcome favors long-tail expansion."</p>
                    </div>
                </div>
            </div>
        </div>
        <!-- Section: Decision Tree Status -->
        <div class="mt-6">
            <h3 class="text-white text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-4">DECISION TREE STATUS
            </h3>
            <div class="grid grid-cols-[48px_1fr] gap-x-2 px-4">
                <!-- Node 1 -->
                <div class="flex flex-col items-center gap-1">
                    <div
                        class="flex size-10 items-center justify-center rounded-full bg-success/20 text-success border border-success/30 shadow-[0_0_15px_rgba(74,222,128,0.2)]">
                        <span class="material-symbols-outlined">check_circle</span>
                    </div>
                    <div class="w-[2px] bg-success/50 h-10"></div>
                </div>
                <div class="flex flex-1 flex-col py-1 pb-6">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-white text-base font-bold leading-none mb-1">Fractal Chaos Filter</p>
                            <p class="text-[#9cb7ba] text-xs font-normal">Signal Strength: 92.4% | Noise: 7.6%</p>
                        </div>
                        <span
                            class="text-[10px] bg-success/10 text-success border border-success/20 px-2 py-0.5 rounded uppercase font-bold">Passed</span>
                    </div>
                    <div class="mt-3 w-full bg-white/5 h-1 rounded-full overflow-hidden">
                        <div class="bg-success h-full" style="width: 92%"></div>
                    </div>
                </div>
                <!-- Node 2 -->
                <div class="flex flex-col items-center gap-1">
                    <div
                        class="flex size-10 items-center justify-center rounded-full bg-success/20 text-success border border-success/30 shadow-[0_0_15px_rgba(74,222,128,0.2)]">
                        <span class="material-symbols-outlined">check_circle</span>
                    </div>
                    <div class="w-[2px] bg-primary h-10"></div>
                </div>
                <div class="flex flex-1 flex-col py-1 pb-6">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-white text-base font-bold leading-none mb-1">Elastic Time Match</p>
                            <p class="text-[#9cb7ba] text-xs font-normal">Multi-timeframe Trend Alignment: CONFIRMED</p>
                        </div>
                        <span
                            class="text-[10px] bg-success/10 text-success border border-success/20 px-2 py-0.5 rounded uppercase font-bold">Passed</span>
                    </div>
                    <div class="mt-3 flex gap-1">
                        <div class="h-8 flex-1 bg-white/5 rounded border border-white/5 flex items-center justify-center"
                            data-alt="Micro sparkline for time trend">
                            <span class="material-symbols-outlined text-primary text-sm opacity-50">show_chart</span>
                        </div>
                        <div class="h-8 flex-1 bg-white/5 rounded border border-white/5 flex items-center justify-center"
                            data-alt="Micro sparkline for time trend">
                            <span class="material-symbols-outlined text-primary text-sm opacity-50">show_chart</span>
                        </div>
                    </div>
                </div>
                <!-- Node 3 (Active/Waiting) -->
                <div class="flex flex-col items-center gap-1">
                    <div
                        class="flex size-10 items-center justify-center rounded-full bg-primary/20 text-primary border border-primary/50 shadow-[0_0_20px_rgba(37,226,244,0.3)] animate-pulse">
                        <span class="material-symbols-outlined">hourglass_empty</span>
                    </div>
                    <div class="w-[2px] bg-white/10 h-10 border-dashed border-l"></div>
                </div>
                <div class="flex flex-1 flex-col py-1 pb-6">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-white text-base font-bold leading-none mb-1">Risk Manager Veto Check</p>
                            <p class="text-[#9cb7ba] text-xs font-normal">Validating against Portfolio Exposure
                                Limits...</p>
                        </div>
                        <span
                            class="text-[10px] bg-primary/10 text-primary border border-primary/20 px-2 py-0.5 rounded uppercase font-bold">Processing</span>
                    </div>
                    <div class="mt-3 p-3 bg-primary/5 rounded border border-primary/20">
                        <p class="text-[11px] text-primary/80 leading-tight italic">Analyzing: current_equity_risk &gt;
                            max_threshold (0.02)</p>
                    </div>
                </div>
            </div>
        </div>
        <!-- Section: Strategy Engine Logic Trace -->
        <div class="mt-4 px-4">
            <div class="flex items-center justify-between mb-3">
                <h3 class="text-white text-lg font-bold leading-tight">LOGIC TRACE</h3>
                <span class="text-[10px] text-white/40 font-mono">strategy_engine.py</span>
            </div>
            <div
                class="bg-[#0c1415] rounded-xl border border-white/10 overflow-hidden font-mono text-[12px] leading-relaxed shadow-2xl">
                <div class="bg-white/5 px-3 py-1.5 flex items-center gap-2 border-b border-white/5">
                    <div class="flex gap-1">
                        <div class="size-2 rounded-full bg-danger/50"></div>
                        <div class="size-2 rounded-full bg-yellow-500/50"></div>
                        <div class="size-2 rounded-full bg-success/50"></div>
                    </div>
                </div>
                <div class="p-4 space-y-1 overflow-x-auto whitespace-nowrap">
                    <div class="flex gap-4 text-white/20"><span>448</span> <span class="text-white/60">def
                            check_veto_status(self, trade):</span></div>
                    <div class="flex gap-4 text-white/20"><span>449</span> <span class="text-white/60 ml-4">risk =
                            trade.calc_exposure()</span></div>
                    <div class="flex gap-4 text-white/20"><span>450</span> <span class="text-white/60 ml-4">if risk &gt;
                            self.max_allowed:</span></div>
                    <div class="flex gap-4 bg-primary/10 border-l-2 border-primary -mx-4 px-4 py-0.5">
                        <span class="text-primary/50">451</span>
                        <span class="text-primary font-bold">return Decision(VETO, "EXPOSURE_LIMIT_EXCEEDED")</span>
                    </div>
                    <div class="flex gap-4 text-white/20"><span>452</span> <span class="text-white/60 ml-4">else:</span>
                    </div>
                    <div class="flex gap-4 text-white/20"><span>453</span> <span class="text-white/60 ml-8">return
                            Decision(PROCEED)</span></div>
                </div>
            </div>
        </div>

        <!-- Section: Global Hunter Radar -->
        <div class="mt-6 px-4">
            <h3 class="text-white text-lg font-bold leading-tight tracking-[-0.015em] mb-4 uppercase">Global Hunter
                Radar</h3>
            <div id="radar_list" class="bg-black/40 border border-white/5 rounded-xl max-h-[300px] overflow-y-auto">
                <p class="text-center py-10 text-white/20 italic">Scanning Global Markets...</p>
            </div>
        </div>
        <!-- Summary Card -->
        <div class="p-4 mt-4">
            <div
                class="bg-gradient-to-br from-background-dark to-[#162e30] border border-white/10 rounded-xl overflow-hidden p-4">
                <div class="flex items-center gap-4">
                    <div class="size-16 rounded-lg bg-center bg-cover border border-white/10"
                        data-alt="Detailed stock analysis chart thumbnail"
                        style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuC-oVJctWFfs4oRpFfAdnlA1-nIrGBwLwh5Ppjfm1Nquz_pJTK9qhBX1uc9EiQd3q2fK_vkq-jS_4YWDUrsShj0B3k9zQTU1fuUjEbgzYUucV-jrBLkvquW575XoHb6I1ritpivh1KSLeoaqUAJLnOroHXgclDrDpBUnDnnTWrpMxA03QDDq3HWhFfihK2N_ECuJHvmsREF8-r9wuwCRMTvc9uOp4SZTDgMhjDKrBeMwnIOL8a9kCxGktmdmjfoNSUB5hfsoPQmyg");'>
                    </div>
                    <div class="flex-1">
                        <div class="flex items-center justify-between">
                            <p class="text-white text-lg font-bold">NVDA Analysis</p>
                            <span class="text-primary text-xs font-bold tracking-widest">+2.4% CONF</span>
                        </div>
                        <p class="text-[#9cb7ba] text-sm font-normal line-clamp-2">
                            Structural pattern matching suggests a breakout. Awaiting risk manager final bit clearance.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Bottom Executive Action Bar (iOS Style) -->
    <div
        class="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-[430px] bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-xl border-t border-white/10 p-4 pb-8 flex items-center justify-between">
        <div class="flex flex-col">
            <span class="text-[10px] text-white/40 uppercase font-bold tracking-widest">Total Asset | Ticks</span>
            <div class="flex items-center gap-2">
                <div class="size-2 rounded-full bg-primary animate-pulse"></div>
                <span class="text-xl font-bold text-white tracking-tight"><span id="balance_text">$10,000.00</span> |
                    <span id="tick_count">0</span></span>
            </div>
        </div>
        <button
            class="bg-primary text-background-dark font-black px-8 py-3 rounded-full text-sm tracking-tighter uppercase flex items-center gap-2 shadow-[0_0_20px_rgba(37,226,244,0.4)]">
            Manual Override
            <span class="material-symbols-outlined text-sm">bolt</span>
        </button>
    </div>
    <script>
        async function updateDashboard() {
            try {
                // 1. Status Fetch
                const statusResp = await fetch('/api/status');
                const status = await statusResp.json();
                document.getElementById('balance_text').innerText = status.balance;
                document.getElementById('tick_count').innerText = status.tick_total;
                document.getElementById('engine_mode_text').innerText = status.engine_mode;
                document.getElementById('last_update_text').innerText = status.last_update;

                // 2. Radar Fetch
                const radarResp = await fetch('/api/radar');
                const radar = await radarResp.json();
                const radarContainer = document.getElementById('radar_list');
                radarContainer.innerHTML = '';

                [...radar.kr, ...radar.us].forEach(stock => {
                    const item = document.createElement('div');
                    item.className = "flex justify-between items-center p-2 border-b border-white/5";
                    item.innerHTML = `
                        <div>
                            <p class="text-white font-bold">${stock.name}</p>
                            <p class="text-[10px] text-white/40">${stock.ticker}</p>
                        </div>
                        <span class="text-xs text-primary font-bold">+${stock.change.toFixed(2)}%</span>
                    `;
                    radarContainer.appendChild(item);
                });

            } catch (e) {
                console.error("Dashboard Update Failed:", e);
            }
        }

        // Initial load and periodic refresh
        updateDashboard();
        setInterval(updateDashboard, 5000);
    </script>
</body>

</html>